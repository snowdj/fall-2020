
# Set working directory
# setwd()


new_data <- read.table('phdLecture3.dat', sep=' ')
names(new_data) <- c('E0013740',
  'R0000100',
  'R0536300',
  'R0536401',
  'R0536402',
  'R1235800',
  'R1302400',
  'R1302500',
  'R1482600',
  'U1700600',
  'U1846100',
  'U1846200',
  'U1846300',
  'U1846400',
  'U1846500',
  'U1846600',
  'U1846700',
  'U1846800',
  'U1846900',
  'U1847000',
  'U1847100',
  'U1847200',
  'U1847300',
  'U1847400',
  'U1847500',
  'U1852600',
  'Z9083800',
  'Z9083900')


# Handle missing values

  new_data[new_data == -1] = NA  # Refused 
  new_data[new_data == -2] = NA  # Dont know 
  new_data[new_data == -3] = NA  # Invalid missing 
  new_data[new_data == -4] = NA  # Valid missing 
  new_data[new_data == -5] = NA  # Non-interview 


# If there are values not categorized they will be represented as NA

vallabels = function(data) {
  data$E0013740[9701.0 <= data$E0013740 & data$E0013740 <= 201799.0] <- 9701.0
  data$E0013740 <- factor(data$E0013740, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,9701.0), 
    labels=c("0: No information reported to account for week; job dates indeterminate",
      "1: Not associated with an employer, not actively searching for an employer job",
      "2: Not working (unemployment vs. out of labor force cannot be determined)",
      "3: Associated with an employer, periods not working for the employer are missing",
      "4: Unemployed",
      "5: Out of the labor force",
      "6: Active military service",
      "9701 TO 201799: Employer on roster (see YEMP_UID)"))
  data$R0000100[1.0 <= data$R0000100 & data$R0000100 <= 999.0] <- 1.0
  data$R0000100[1000.0 <= data$R0000100 & data$R0000100 <= 1999.0] <- 1000.0
  data$R0000100[2000.0 <= data$R0000100 & data$R0000100 <= 2999.0] <- 2000.0
  data$R0000100[3000.0 <= data$R0000100 & data$R0000100 <= 3999.0] <- 3000.0
  data$R0000100[4000.0 <= data$R0000100 & data$R0000100 <= 4999.0] <- 4000.0
  data$R0000100[5000.0 <= data$R0000100 & data$R0000100 <= 5999.0] <- 5000.0
  data$R0000100[6000.0 <= data$R0000100 & data$R0000100 <= 6999.0] <- 6000.0
  data$R0000100[7000.0 <= data$R0000100 & data$R0000100 <= 7999.0] <- 7000.0
  data$R0000100[8000.0 <= data$R0000100 & data$R0000100 <= 8999.0] <- 8000.0
  data$R0000100[9000.0 <= data$R0000100 & data$R0000100 <= 9999.0] <- 9000.0
  data$R0000100 <- factor(data$R0000100, 
    levels=c(0.0,1.0,1000.0,2000.0,3000.0,4000.0,5000.0,6000.0,7000.0,8000.0,9000.0), 
    labels=c("0",
      "1 TO 999",
      "1000 TO 1999",
      "2000 TO 2999",
      "3000 TO 3999",
      "4000 TO 4999",
      "5000 TO 5999",
      "6000 TO 6999",
      "7000 TO 7999",
      "8000 TO 8999",
      "9000 TO 9999"))
  data$R0536300 <- factor(data$R0536300, 
    levels=c(0.0,1.0,2.0), 
    labels=c("No Information",
      "Male",
      "Female"))
  data$R0536401 <- factor(data$R0536401, 
    levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0), 
    labels=c("1: January",
      "2: February",
      "3: March",
      "4: April",
      "5: May",
      "6: June",
      "7: July",
      "8: August",
      "9: September",
      "10: October",
      "11: November",
      "12: December"))
  data$R1235800 <- factor(data$R1235800, 
    levels=c(0.0,1.0), 
    labels=c("Oversample",
      "Cross-sectional"))
  data$R1302400 <- factor(data$R1302400, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0), 
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YEAR COLLEGE",
      "2ND YEAR COLLEGE",
      "3RD YEAR COLLEGE",
      "4TH YEAR COLLEGE",
      "5TH YEAR COLLEGE",
      "6TH YEAR COLLEGE",
      "7TH YEAR COLLEGE",
      "8TH YEAR COLLEGE OR MORE",
      "UNGRADED"))
  data$R1302500 <- factor(data$R1302500, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0), 
    labels=c("NONE",
      "1ST GRADE",
      "2ND GRADE",
      "3RD GRADE",
      "4TH GRADE",
      "5TH GRADE",
      "6TH GRADE",
      "7TH GRADE",
      "8TH GRADE",
      "9TH GRADE",
      "10TH GRADE",
      "11TH GRADE",
      "12TH GRADE",
      "1ST YEAR COLLEGE",
      "2ND YEAR COLLEGE",
      "3RD YEAR COLLEGE",
      "4TH YEAR COLLEGE",
      "5TH YEAR COLLEGE",
      "6TH YEAR COLLEGE",
      "7TH YEAR COLLEGE",
      "8TH YEAR COLLEGE OR MORE",
      "UNGRADED"))
  data$R1482600 <- factor(data$R1482600, 
    levels=c(1.0,2.0,3.0,4.0), 
    labels=c("Black",
      "Hispanic",
      "Mixed Race (Non-Hispanic)",
      "Non-Black / Non-Hispanic"))
  data$U1700600 <- factor(data$U1700600, 
    levels=c(60.0,61.0,62.0,63.0,64.0,65.0,66.0,67.0,80.0,89.0,90.0,91.0,92.0,93.0,94.0,95.0,96.0,97.0,98.0,99.0,113.0), 
    labels=c("Completed in person",
      "Completed by phone",
      "Comp in person/conv",
      "Comp by phone/conv",
      "Compy by proxy parent/R disabled",
      "Comp by proxy nonparent/R disabled",
      "Comp in person/incarcerated",
      "Comp by phone/incarcerated",
      "Prior deceased blocked (not fielded)",
      "NIR blocked",
      "Final unlocatable",
      "Very hostile refusal",
      "Gatekeeper Refusal",
      "R - inaccessible - military",
      "R too ill/handicapped",
      "R - inaccessible - prison",
      "Refusal",
      "Hostile refusal",
      "Deceased (current round)",
      "Other",
      "Refusal - Prison"))
  data$U1846100[1.0 <= data$U1846100 & data$U1846100 <= 99.0] <- 1.0
  data$U1846100[100.0 <= data$U1846100 & data$U1846100 <= 199.0] <- 100.0
  data$U1846100[200.0 <= data$U1846100 & data$U1846100 <= 299.0] <- 200.0
  data$U1846100[300.0 <= data$U1846100 & data$U1846100 <= 399.0] <- 300.0
  data$U1846100[400.0 <= data$U1846100 & data$U1846100 <= 499.0] <- 400.0
  data$U1846100[500.0 <= data$U1846100 & data$U1846100 <= 599.0] <- 500.0
  data$U1846100[600.0 <= data$U1846100 & data$U1846100 <= 699.0] <- 600.0
  data$U1846100[700.0 <= data$U1846100 & data$U1846100 <= 799.0] <- 700.0
  data$U1846100[800.0 <= data$U1846100 & data$U1846100 <= 899.0] <- 800.0
  data$U1846100[900.0 <= data$U1846100 & data$U1846100 <= 999.0] <- 900.0
  data$U1846100[1000.0 <= data$U1846100 & data$U1846100 <= 1099.0] <- 1000.0
  data$U1846100[1100.0 <= data$U1846100 & data$U1846100 <= 1199.0] <- 1100.0
  data$U1846100[1200.0 <= data$U1846100 & data$U1846100 <= 1299.0] <- 1200.0
  data$U1846100[1300.0 <= data$U1846100 & data$U1846100 <= 1399.0] <- 1300.0
  data$U1846100[1400.0 <= data$U1846100 & data$U1846100 <= 1499.0] <- 1400.0
  data$U1846100[1500.0 <= data$U1846100 & data$U1846100 <= 9999999.0] <- 1500.0
  data$U1846100 <- factor(data$U1846100, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846200[1.0 <= data$U1846200 & data$U1846200 <= 99.0] <- 1.0
  data$U1846200[100.0 <= data$U1846200 & data$U1846200 <= 199.0] <- 100.0
  data$U1846200[200.0 <= data$U1846200 & data$U1846200 <= 299.0] <- 200.0
  data$U1846200[300.0 <= data$U1846200 & data$U1846200 <= 399.0] <- 300.0
  data$U1846200[400.0 <= data$U1846200 & data$U1846200 <= 499.0] <- 400.0
  data$U1846200[500.0 <= data$U1846200 & data$U1846200 <= 599.0] <- 500.0
  data$U1846200[600.0 <= data$U1846200 & data$U1846200 <= 699.0] <- 600.0
  data$U1846200[700.0 <= data$U1846200 & data$U1846200 <= 799.0] <- 700.0
  data$U1846200[800.0 <= data$U1846200 & data$U1846200 <= 899.0] <- 800.0
  data$U1846200[900.0 <= data$U1846200 & data$U1846200 <= 999.0] <- 900.0
  data$U1846200[1000.0 <= data$U1846200 & data$U1846200 <= 1099.0] <- 1000.0
  data$U1846200[1100.0 <= data$U1846200 & data$U1846200 <= 1199.0] <- 1100.0
  data$U1846200[1200.0 <= data$U1846200 & data$U1846200 <= 1299.0] <- 1200.0
  data$U1846200[1300.0 <= data$U1846200 & data$U1846200 <= 1399.0] <- 1300.0
  data$U1846200[1400.0 <= data$U1846200 & data$U1846200 <= 1499.0] <- 1400.0
  data$U1846200[1500.0 <= data$U1846200 & data$U1846200 <= 9999999.0] <- 1500.0
  data$U1846200 <- factor(data$U1846200, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846300[1.0 <= data$U1846300 & data$U1846300 <= 99.0] <- 1.0
  data$U1846300[100.0 <= data$U1846300 & data$U1846300 <= 199.0] <- 100.0
  data$U1846300[200.0 <= data$U1846300 & data$U1846300 <= 299.0] <- 200.0
  data$U1846300[300.0 <= data$U1846300 & data$U1846300 <= 399.0] <- 300.0
  data$U1846300[400.0 <= data$U1846300 & data$U1846300 <= 499.0] <- 400.0
  data$U1846300[500.0 <= data$U1846300 & data$U1846300 <= 599.0] <- 500.0
  data$U1846300[600.0 <= data$U1846300 & data$U1846300 <= 699.0] <- 600.0
  data$U1846300[700.0 <= data$U1846300 & data$U1846300 <= 799.0] <- 700.0
  data$U1846300[800.0 <= data$U1846300 & data$U1846300 <= 899.0] <- 800.0
  data$U1846300[900.0 <= data$U1846300 & data$U1846300 <= 999.0] <- 900.0
  data$U1846300[1000.0 <= data$U1846300 & data$U1846300 <= 1099.0] <- 1000.0
  data$U1846300[1100.0 <= data$U1846300 & data$U1846300 <= 1199.0] <- 1100.0
  data$U1846300[1200.0 <= data$U1846300 & data$U1846300 <= 1299.0] <- 1200.0
  data$U1846300[1300.0 <= data$U1846300 & data$U1846300 <= 1399.0] <- 1300.0
  data$U1846300[1400.0 <= data$U1846300 & data$U1846300 <= 1499.0] <- 1400.0
  data$U1846300[1500.0 <= data$U1846300 & data$U1846300 <= 9999999.0] <- 1500.0
  data$U1846300 <- factor(data$U1846300, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846400[1.0 <= data$U1846400 & data$U1846400 <= 99.0] <- 1.0
  data$U1846400[100.0 <= data$U1846400 & data$U1846400 <= 199.0] <- 100.0
  data$U1846400[200.0 <= data$U1846400 & data$U1846400 <= 299.0] <- 200.0
  data$U1846400[300.0 <= data$U1846400 & data$U1846400 <= 399.0] <- 300.0
  data$U1846400[400.0 <= data$U1846400 & data$U1846400 <= 499.0] <- 400.0
  data$U1846400[500.0 <= data$U1846400 & data$U1846400 <= 599.0] <- 500.0
  data$U1846400[600.0 <= data$U1846400 & data$U1846400 <= 699.0] <- 600.0
  data$U1846400[700.0 <= data$U1846400 & data$U1846400 <= 799.0] <- 700.0
  data$U1846400[800.0 <= data$U1846400 & data$U1846400 <= 899.0] <- 800.0
  data$U1846400[900.0 <= data$U1846400 & data$U1846400 <= 999.0] <- 900.0
  data$U1846400[1000.0 <= data$U1846400 & data$U1846400 <= 1099.0] <- 1000.0
  data$U1846400[1100.0 <= data$U1846400 & data$U1846400 <= 1199.0] <- 1100.0
  data$U1846400[1200.0 <= data$U1846400 & data$U1846400 <= 1299.0] <- 1200.0
  data$U1846400[1300.0 <= data$U1846400 & data$U1846400 <= 1399.0] <- 1300.0
  data$U1846400[1400.0 <= data$U1846400 & data$U1846400 <= 1499.0] <- 1400.0
  data$U1846400[1500.0 <= data$U1846400 & data$U1846400 <= 9999999.0] <- 1500.0
  data$U1846400 <- factor(data$U1846400, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846500[1.0 <= data$U1846500 & data$U1846500 <= 99.0] <- 1.0
  data$U1846500[100.0 <= data$U1846500 & data$U1846500 <= 199.0] <- 100.0
  data$U1846500[200.0 <= data$U1846500 & data$U1846500 <= 299.0] <- 200.0
  data$U1846500[300.0 <= data$U1846500 & data$U1846500 <= 399.0] <- 300.0
  data$U1846500[400.0 <= data$U1846500 & data$U1846500 <= 499.0] <- 400.0
  data$U1846500[500.0 <= data$U1846500 & data$U1846500 <= 599.0] <- 500.0
  data$U1846500[600.0 <= data$U1846500 & data$U1846500 <= 699.0] <- 600.0
  data$U1846500[700.0 <= data$U1846500 & data$U1846500 <= 799.0] <- 700.0
  data$U1846500[800.0 <= data$U1846500 & data$U1846500 <= 899.0] <- 800.0
  data$U1846500[900.0 <= data$U1846500 & data$U1846500 <= 999.0] <- 900.0
  data$U1846500[1000.0 <= data$U1846500 & data$U1846500 <= 1099.0] <- 1000.0
  data$U1846500[1100.0 <= data$U1846500 & data$U1846500 <= 1199.0] <- 1100.0
  data$U1846500[1200.0 <= data$U1846500 & data$U1846500 <= 1299.0] <- 1200.0
  data$U1846500[1300.0 <= data$U1846500 & data$U1846500 <= 1399.0] <- 1300.0
  data$U1846500[1400.0 <= data$U1846500 & data$U1846500 <= 1499.0] <- 1400.0
  data$U1846500[1500.0 <= data$U1846500 & data$U1846500 <= 9999999.0] <- 1500.0
  data$U1846500 <- factor(data$U1846500, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846600[1.0 <= data$U1846600 & data$U1846600 <= 99.0] <- 1.0
  data$U1846600[100.0 <= data$U1846600 & data$U1846600 <= 199.0] <- 100.0
  data$U1846600[200.0 <= data$U1846600 & data$U1846600 <= 299.0] <- 200.0
  data$U1846600[300.0 <= data$U1846600 & data$U1846600 <= 399.0] <- 300.0
  data$U1846600[400.0 <= data$U1846600 & data$U1846600 <= 499.0] <- 400.0
  data$U1846600[500.0 <= data$U1846600 & data$U1846600 <= 599.0] <- 500.0
  data$U1846600[600.0 <= data$U1846600 & data$U1846600 <= 699.0] <- 600.0
  data$U1846600[700.0 <= data$U1846600 & data$U1846600 <= 799.0] <- 700.0
  data$U1846600[800.0 <= data$U1846600 & data$U1846600 <= 899.0] <- 800.0
  data$U1846600[900.0 <= data$U1846600 & data$U1846600 <= 999.0] <- 900.0
  data$U1846600[1000.0 <= data$U1846600 & data$U1846600 <= 1099.0] <- 1000.0
  data$U1846600[1100.0 <= data$U1846600 & data$U1846600 <= 1199.0] <- 1100.0
  data$U1846600[1200.0 <= data$U1846600 & data$U1846600 <= 1299.0] <- 1200.0
  data$U1846600[1300.0 <= data$U1846600 & data$U1846600 <= 1399.0] <- 1300.0
  data$U1846600[1400.0 <= data$U1846600 & data$U1846600 <= 1499.0] <- 1400.0
  data$U1846600[1500.0 <= data$U1846600 & data$U1846600 <= 9999999.0] <- 1500.0
  data$U1846600 <- factor(data$U1846600, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846700[1.0 <= data$U1846700 & data$U1846700 <= 99.0] <- 1.0
  data$U1846700[100.0 <= data$U1846700 & data$U1846700 <= 199.0] <- 100.0
  data$U1846700[200.0 <= data$U1846700 & data$U1846700 <= 299.0] <- 200.0
  data$U1846700[300.0 <= data$U1846700 & data$U1846700 <= 399.0] <- 300.0
  data$U1846700[400.0 <= data$U1846700 & data$U1846700 <= 499.0] <- 400.0
  data$U1846700[500.0 <= data$U1846700 & data$U1846700 <= 599.0] <- 500.0
  data$U1846700[600.0 <= data$U1846700 & data$U1846700 <= 699.0] <- 600.0
  data$U1846700[700.0 <= data$U1846700 & data$U1846700 <= 799.0] <- 700.0
  data$U1846700[800.0 <= data$U1846700 & data$U1846700 <= 899.0] <- 800.0
  data$U1846700[900.0 <= data$U1846700 & data$U1846700 <= 999.0] <- 900.0
  data$U1846700[1000.0 <= data$U1846700 & data$U1846700 <= 1099.0] <- 1000.0
  data$U1846700[1100.0 <= data$U1846700 & data$U1846700 <= 1199.0] <- 1100.0
  data$U1846700[1200.0 <= data$U1846700 & data$U1846700 <= 1299.0] <- 1200.0
  data$U1846700[1300.0 <= data$U1846700 & data$U1846700 <= 1399.0] <- 1300.0
  data$U1846700[1400.0 <= data$U1846700 & data$U1846700 <= 1499.0] <- 1400.0
  data$U1846700[1500.0 <= data$U1846700 & data$U1846700 <= 9999999.0] <- 1500.0
  data$U1846700 <- factor(data$U1846700, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846800[1.0 <= data$U1846800 & data$U1846800 <= 99.0] <- 1.0
  data$U1846800[100.0 <= data$U1846800 & data$U1846800 <= 199.0] <- 100.0
  data$U1846800[200.0 <= data$U1846800 & data$U1846800 <= 299.0] <- 200.0
  data$U1846800[300.0 <= data$U1846800 & data$U1846800 <= 399.0] <- 300.0
  data$U1846800[400.0 <= data$U1846800 & data$U1846800 <= 499.0] <- 400.0
  data$U1846800[500.0 <= data$U1846800 & data$U1846800 <= 599.0] <- 500.0
  data$U1846800[600.0 <= data$U1846800 & data$U1846800 <= 699.0] <- 600.0
  data$U1846800[700.0 <= data$U1846800 & data$U1846800 <= 799.0] <- 700.0
  data$U1846800[800.0 <= data$U1846800 & data$U1846800 <= 899.0] <- 800.0
  data$U1846800[900.0 <= data$U1846800 & data$U1846800 <= 999.0] <- 900.0
  data$U1846800[1000.0 <= data$U1846800 & data$U1846800 <= 1099.0] <- 1000.0
  data$U1846800[1100.0 <= data$U1846800 & data$U1846800 <= 1199.0] <- 1100.0
  data$U1846800[1200.0 <= data$U1846800 & data$U1846800 <= 1299.0] <- 1200.0
  data$U1846800[1300.0 <= data$U1846800 & data$U1846800 <= 1399.0] <- 1300.0
  data$U1846800[1400.0 <= data$U1846800 & data$U1846800 <= 1499.0] <- 1400.0
  data$U1846800[1500.0 <= data$U1846800 & data$U1846800 <= 9999999.0] <- 1500.0
  data$U1846800 <- factor(data$U1846800, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1846900[1.0 <= data$U1846900 & data$U1846900 <= 99.0] <- 1.0
  data$U1846900[100.0 <= data$U1846900 & data$U1846900 <= 199.0] <- 100.0
  data$U1846900[200.0 <= data$U1846900 & data$U1846900 <= 299.0] <- 200.0
  data$U1846900[300.0 <= data$U1846900 & data$U1846900 <= 399.0] <- 300.0
  data$U1846900[400.0 <= data$U1846900 & data$U1846900 <= 499.0] <- 400.0
  data$U1846900[500.0 <= data$U1846900 & data$U1846900 <= 599.0] <- 500.0
  data$U1846900[600.0 <= data$U1846900 & data$U1846900 <= 699.0] <- 600.0
  data$U1846900[700.0 <= data$U1846900 & data$U1846900 <= 799.0] <- 700.0
  data$U1846900[800.0 <= data$U1846900 & data$U1846900 <= 899.0] <- 800.0
  data$U1846900[900.0 <= data$U1846900 & data$U1846900 <= 999.0] <- 900.0
  data$U1846900[1000.0 <= data$U1846900 & data$U1846900 <= 1099.0] <- 1000.0
  data$U1846900[1100.0 <= data$U1846900 & data$U1846900 <= 1199.0] <- 1100.0
  data$U1846900[1200.0 <= data$U1846900 & data$U1846900 <= 1299.0] <- 1200.0
  data$U1846900[1300.0 <= data$U1846900 & data$U1846900 <= 1399.0] <- 1300.0
  data$U1846900[1400.0 <= data$U1846900 & data$U1846900 <= 1499.0] <- 1400.0
  data$U1846900[1500.0 <= data$U1846900 & data$U1846900 <= 9999999.0] <- 1500.0
  data$U1846900 <- factor(data$U1846900, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847000[1.0 <= data$U1847000 & data$U1847000 <= 99.0] <- 1.0
  data$U1847000[100.0 <= data$U1847000 & data$U1847000 <= 199.0] <- 100.0
  data$U1847000[200.0 <= data$U1847000 & data$U1847000 <= 299.0] <- 200.0
  data$U1847000[300.0 <= data$U1847000 & data$U1847000 <= 399.0] <- 300.0
  data$U1847000[400.0 <= data$U1847000 & data$U1847000 <= 499.0] <- 400.0
  data$U1847000[500.0 <= data$U1847000 & data$U1847000 <= 599.0] <- 500.0
  data$U1847000[600.0 <= data$U1847000 & data$U1847000 <= 699.0] <- 600.0
  data$U1847000[700.0 <= data$U1847000 & data$U1847000 <= 799.0] <- 700.0
  data$U1847000[800.0 <= data$U1847000 & data$U1847000 <= 899.0] <- 800.0
  data$U1847000[900.0 <= data$U1847000 & data$U1847000 <= 999.0] <- 900.0
  data$U1847000[1000.0 <= data$U1847000 & data$U1847000 <= 1099.0] <- 1000.0
  data$U1847000[1100.0 <= data$U1847000 & data$U1847000 <= 1199.0] <- 1100.0
  data$U1847000[1200.0 <= data$U1847000 & data$U1847000 <= 1299.0] <- 1200.0
  data$U1847000[1300.0 <= data$U1847000 & data$U1847000 <= 1399.0] <- 1300.0
  data$U1847000[1400.0 <= data$U1847000 & data$U1847000 <= 1499.0] <- 1400.0
  data$U1847000[1500.0 <= data$U1847000 & data$U1847000 <= 9999999.0] <- 1500.0
  data$U1847000 <- factor(data$U1847000, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847100[1.0 <= data$U1847100 & data$U1847100 <= 99.0] <- 1.0
  data$U1847100[100.0 <= data$U1847100 & data$U1847100 <= 199.0] <- 100.0
  data$U1847100[200.0 <= data$U1847100 & data$U1847100 <= 299.0] <- 200.0
  data$U1847100[300.0 <= data$U1847100 & data$U1847100 <= 399.0] <- 300.0
  data$U1847100[400.0 <= data$U1847100 & data$U1847100 <= 499.0] <- 400.0
  data$U1847100[500.0 <= data$U1847100 & data$U1847100 <= 599.0] <- 500.0
  data$U1847100[600.0 <= data$U1847100 & data$U1847100 <= 699.0] <- 600.0
  data$U1847100[700.0 <= data$U1847100 & data$U1847100 <= 799.0] <- 700.0
  data$U1847100[800.0 <= data$U1847100 & data$U1847100 <= 899.0] <- 800.0
  data$U1847100[900.0 <= data$U1847100 & data$U1847100 <= 999.0] <- 900.0
  data$U1847100[1000.0 <= data$U1847100 & data$U1847100 <= 1099.0] <- 1000.0
  data$U1847100[1100.0 <= data$U1847100 & data$U1847100 <= 1199.0] <- 1100.0
  data$U1847100[1200.0 <= data$U1847100 & data$U1847100 <= 1299.0] <- 1200.0
  data$U1847100[1300.0 <= data$U1847100 & data$U1847100 <= 1399.0] <- 1300.0
  data$U1847100[1400.0 <= data$U1847100 & data$U1847100 <= 1499.0] <- 1400.0
  data$U1847100[1500.0 <= data$U1847100 & data$U1847100 <= 9999999.0] <- 1500.0
  data$U1847100 <- factor(data$U1847100, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847200[1.0 <= data$U1847200 & data$U1847200 <= 99.0] <- 1.0
  data$U1847200[100.0 <= data$U1847200 & data$U1847200 <= 199.0] <- 100.0
  data$U1847200[200.0 <= data$U1847200 & data$U1847200 <= 299.0] <- 200.0
  data$U1847200[300.0 <= data$U1847200 & data$U1847200 <= 399.0] <- 300.0
  data$U1847200[400.0 <= data$U1847200 & data$U1847200 <= 499.0] <- 400.0
  data$U1847200[500.0 <= data$U1847200 & data$U1847200 <= 599.0] <- 500.0
  data$U1847200[600.0 <= data$U1847200 & data$U1847200 <= 699.0] <- 600.0
  data$U1847200[700.0 <= data$U1847200 & data$U1847200 <= 799.0] <- 700.0
  data$U1847200[800.0 <= data$U1847200 & data$U1847200 <= 899.0] <- 800.0
  data$U1847200[900.0 <= data$U1847200 & data$U1847200 <= 999.0] <- 900.0
  data$U1847200[1000.0 <= data$U1847200 & data$U1847200 <= 1099.0] <- 1000.0
  data$U1847200[1100.0 <= data$U1847200 & data$U1847200 <= 1199.0] <- 1100.0
  data$U1847200[1200.0 <= data$U1847200 & data$U1847200 <= 1299.0] <- 1200.0
  data$U1847200[1300.0 <= data$U1847200 & data$U1847200 <= 1399.0] <- 1300.0
  data$U1847200[1400.0 <= data$U1847200 & data$U1847200 <= 1499.0] <- 1400.0
  data$U1847200[1500.0 <= data$U1847200 & data$U1847200 <= 9999999.0] <- 1500.0
  data$U1847200 <- factor(data$U1847200, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847300[1.0 <= data$U1847300 & data$U1847300 <= 99.0] <- 1.0
  data$U1847300[100.0 <= data$U1847300 & data$U1847300 <= 199.0] <- 100.0
  data$U1847300[200.0 <= data$U1847300 & data$U1847300 <= 299.0] <- 200.0
  data$U1847300[300.0 <= data$U1847300 & data$U1847300 <= 399.0] <- 300.0
  data$U1847300[400.0 <= data$U1847300 & data$U1847300 <= 499.0] <- 400.0
  data$U1847300[500.0 <= data$U1847300 & data$U1847300 <= 599.0] <- 500.0
  data$U1847300[600.0 <= data$U1847300 & data$U1847300 <= 699.0] <- 600.0
  data$U1847300[700.0 <= data$U1847300 & data$U1847300 <= 799.0] <- 700.0
  data$U1847300[800.0 <= data$U1847300 & data$U1847300 <= 899.0] <- 800.0
  data$U1847300[900.0 <= data$U1847300 & data$U1847300 <= 999.0] <- 900.0
  data$U1847300[1000.0 <= data$U1847300 & data$U1847300 <= 1099.0] <- 1000.0
  data$U1847300[1100.0 <= data$U1847300 & data$U1847300 <= 1199.0] <- 1100.0
  data$U1847300[1200.0 <= data$U1847300 & data$U1847300 <= 1299.0] <- 1200.0
  data$U1847300[1300.0 <= data$U1847300 & data$U1847300 <= 1399.0] <- 1300.0
  data$U1847300[1400.0 <= data$U1847300 & data$U1847300 <= 1499.0] <- 1400.0
  data$U1847300[1500.0 <= data$U1847300 & data$U1847300 <= 9999999.0] <- 1500.0
  data$U1847300 <- factor(data$U1847300, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847400[1.0 <= data$U1847400 & data$U1847400 <= 99.0] <- 1.0
  data$U1847400[100.0 <= data$U1847400 & data$U1847400 <= 199.0] <- 100.0
  data$U1847400[200.0 <= data$U1847400 & data$U1847400 <= 299.0] <- 200.0
  data$U1847400[300.0 <= data$U1847400 & data$U1847400 <= 399.0] <- 300.0
  data$U1847400[400.0 <= data$U1847400 & data$U1847400 <= 499.0] <- 400.0
  data$U1847400[500.0 <= data$U1847400 & data$U1847400 <= 599.0] <- 500.0
  data$U1847400[600.0 <= data$U1847400 & data$U1847400 <= 699.0] <- 600.0
  data$U1847400[700.0 <= data$U1847400 & data$U1847400 <= 799.0] <- 700.0
  data$U1847400[800.0 <= data$U1847400 & data$U1847400 <= 899.0] <- 800.0
  data$U1847400[900.0 <= data$U1847400 & data$U1847400 <= 999.0] <- 900.0
  data$U1847400[1000.0 <= data$U1847400 & data$U1847400 <= 1099.0] <- 1000.0
  data$U1847400[1100.0 <= data$U1847400 & data$U1847400 <= 1199.0] <- 1100.0
  data$U1847400[1200.0 <= data$U1847400 & data$U1847400 <= 1299.0] <- 1200.0
  data$U1847400[1300.0 <= data$U1847400 & data$U1847400 <= 1399.0] <- 1300.0
  data$U1847400[1400.0 <= data$U1847400 & data$U1847400 <= 1499.0] <- 1400.0
  data$U1847400[1500.0 <= data$U1847400 & data$U1847400 <= 9999999.0] <- 1500.0
  data$U1847400 <- factor(data$U1847400, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1847500[1.0 <= data$U1847500 & data$U1847500 <= 99.0] <- 1.0
  data$U1847500[100.0 <= data$U1847500 & data$U1847500 <= 199.0] <- 100.0
  data$U1847500[200.0 <= data$U1847500 & data$U1847500 <= 299.0] <- 200.0
  data$U1847500[300.0 <= data$U1847500 & data$U1847500 <= 399.0] <- 300.0
  data$U1847500[400.0 <= data$U1847500 & data$U1847500 <= 499.0] <- 400.0
  data$U1847500[500.0 <= data$U1847500 & data$U1847500 <= 599.0] <- 500.0
  data$U1847500[600.0 <= data$U1847500 & data$U1847500 <= 699.0] <- 600.0
  data$U1847500[700.0 <= data$U1847500 & data$U1847500 <= 799.0] <- 700.0
  data$U1847500[800.0 <= data$U1847500 & data$U1847500 <= 899.0] <- 800.0
  data$U1847500[900.0 <= data$U1847500 & data$U1847500 <= 999.0] <- 900.0
  data$U1847500[1000.0 <= data$U1847500 & data$U1847500 <= 1099.0] <- 1000.0
  data$U1847500[1100.0 <= data$U1847500 & data$U1847500 <= 1199.0] <- 1100.0
  data$U1847500[1200.0 <= data$U1847500 & data$U1847500 <= 1299.0] <- 1200.0
  data$U1847500[1300.0 <= data$U1847500 & data$U1847500 <= 1399.0] <- 1300.0
  data$U1847500[1400.0 <= data$U1847500 & data$U1847500 <= 1499.0] <- 1400.0
  data$U1847500[1500.0 <= data$U1847500 & data$U1847500 <= 9999999.0] <- 1500.0
  data$U1847500 <- factor(data$U1847500, 
    levels=c(0.0,1.0,100.0,200.0,300.0,400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0), 
    labels=c("0",
      "1 TO 99: .01-.99",
      "100 TO 199: 1.00-1.99",
      "200 TO 299: 2.00-2.99",
      "300 TO 399: 3.00-3.99",
      "400 TO 499: 4.00-4.99",
      "500 TO 599: 5.00-5.99",
      "600 TO 699: 6.00-6.99",
      "700 TO 799: 7.00-7.99",
      "800 TO 899: 8.00-8.99",
      "900 TO 999: 9.00-9.99",
      "1000 TO 1099: 10.00-10.99",
      "1100 TO 1199: 11.00-11.99",
      "1200 TO 1299: 12.00-12.99",
      "1300 TO 1399: 13.00-13.99",
      "1400 TO 1499: 14.00-14.99",
      "1500 TO 9999999: 15.00+"))
  data$U1852600[10.0 <= data$U1852600 & data$U1852600 <= 999.0] <- 10.0
  data$U1852600 <- factor(data$U1852600, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0), 
    labels=c("0",
      "1",
      "2",
      "3",
      "4",
      "5",
      "6",
      "7",
      "8",
      "9",
      "10 TO 999: 10+"))
  data$Z9083800 <- factor(data$Z9083800, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0), 
    labels=c("None",
      "1st grade",
      "2nd grade",
      "3rd grade",
      "4th grade",
      "5th grade",
      "6th grade",
      "7th grade",
      "8th grade",
      "9th grade",
      "10th grade",
      "11th grade",
      "12th grade",
      "1st year college",
      "2nd year college",
      "3rd year college",
      "4th year college",
      "5th year college",
      "6th year college",
      "7th year college",
      "8th year college or more",
      "Ungraded"))
  data$Z9083900 <- factor(data$Z9083900, 
    levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0), 
    labels=c("None",
      "GED",
      "High school diploma (Regular 12 year program)",
      "Associate/Junior college (AA)",
      "Bachelor's degree (BA, BS)",
      "Master's degree (MA, MS)",
      "PhD",
      "Professional degree (DDS, JD, MD)"))
  return(data)
}

varlabels <- c("2017 EMP: EMP STAT WK L40",
  "PUBID - YTH ID CODE 1997",
  "KEY!SEX (SYMBOL) 1997",
  "KEY!BDATE M/Y (SYMBOL) 1997",
  "KEY!BDATE M/Y (SYMBOL) 1997",
  "CV_SAMPLE_TYPE 1997",
  "CV_HGC_BIO_DAD 1997",
  "CV_HGC_BIO_MOM 1997",
  "KEY!RACE_ETHNICITY (SYMBOL) 1997",
  "REASON FOR NON INTERVIEW 2017",
  "CV_HRLY_COMPENSATION L1 2017",
  "CV_HRLY_COMPENSATION L2 2017",
  "CV_HRLY_COMPENSATION L3 2017",
  "CV_HRLY_COMPENSATION L4 2017",
  "CV_HRLY_COMPENSATION L5 2017",
  "CV_HRLY_COMPENSATION L6 2017",
  "CV_HRLY_COMPENSATION L7 2017",
  "CV_HRLY_COMPENSATION L8 2017",
  "CV_HRLY_COMPENSATION L9 2017",
  "CV_HRLY_COMPENSATION L10 2017",
  "CV_HRLY_COMPENSATION L11 2017",
  "CV_HRLY_COMPENSATION L12 2017",
  "CV_HRLY_COMPENSATION L13 2017",
  "CV_HRLY_COMPENSATION L14 2017",
  "CV_HRLY_COMPENSATION L15 2017",
  "CV_BIO_CHILD_HH 2017",
  "CVC_HGC_EVER",
  "CVC_HIGHEST_DEGREE_EVER"
)


# Use qnames rather than rnums

qnames = function(data) {
  names(data) <- c("EMP_STATUS_2017.40_XRND",
    "PUBID_1997",
    "KEY_SEX_1997",
    "KEY_BDATE_M_1997",
    "KEY_BDATE_Y_1997",
    "CV_SAMPLE_TYPE_1997",
    "CV_HGC_BIO_DAD_1997",
    "CV_HGC_BIO_MOM_1997",
    "KEY_RACE_ETHNICITY_1997",
    "RNI_2017",
    "CV_HRLY_COMPENSATION.01_2017",
    "CV_HRLY_COMPENSATION.02_2017",
    "CV_HRLY_COMPENSATION.03_2017",
    "CV_HRLY_COMPENSATION.04_2017",
    "CV_HRLY_COMPENSATION.05_2017",
    "CV_HRLY_COMPENSATION.06_2017",
    "CV_HRLY_COMPENSATION.07_2017",
    "CV_HRLY_COMPENSATION.08_2017",
    "CV_HRLY_COMPENSATION.09_2017",
    "CV_HRLY_COMPENSATION.10_2017",
    "CV_HRLY_COMPENSATION.11_2017",
    "CV_HRLY_COMPENSATION.12_2017",
    "CV_HRLY_COMPENSATION.13_2017",
    "CV_HRLY_COMPENSATION.14_2017",
    "CV_HRLY_COMPENSATION.15_2017",
    "CV_BIO_CHILD_HH_2017",
    "CVC_HGC_EVER_XRND",
    "CVC_HIGHEST_DEGREE_EVER_XRND")
  return(data)
}


#********************************************************************************************************

# Remove the '#' before the following line to create a data file called "categories" with value labels. 
#categories <- vallabels(new_data)

# Remove the '#' before the following lines to rename variables using Qnames instead of Reference Numbers
#new_data <- qnames(new_data)
#categories <- qnames(categories)

# Produce summaries for the raw (uncategorized) data file
summary(new_data)

# Remove the '#' before the following lines to produce summaries for the "categories" data file.
#categories <- vallabels(new_data)
#summary(categories)

#************************************************************************************************************

df       <- new_data %>% as_tibble
new_data <- NULL

# rename variables
df %<>% rename(
    empstat   = `E0013740`,
    id        = `R0000100`,
    sex       = `R0536300`,
    bmonth    = `R0536401`,
    byear     = `R0536402`,
    samptype  = `R1235800`,
    race      = `R1482600`,
    compJob1  = `U1846100`,
    compJob2  = `U1846200`,
    compJob3  = `U1846300`,
    compJob4  = `U1846400`,
    compJob5  = `U1846500`,
    compJob6  = `U1846600`,
    compJob7  = `U1846700`,
    compJob8  = `U1846800`,
    compJob9  = `U1846900`,
    compJob10 = `U1847000`,
    compJob11 = `U1847100`,
    compJob12 = `U1847200`,
    compJob13 = `U1847300`,
    compJob14 = `U1847400`,
    compJob15 = `U1847500`,
    numkids   = `U1852600`,
    hgc       = `Z9083800`,
    hideg     = `Z9083900`,
    hgcFath   = `R1302400`,
    hgcMoth   = `R1302500`,
    rni       = `U1700600`)

# college costs (merge in from external source)
efcdat <- read_csv('efc_data.csv')
df %<>% left_join(efcdat, by="id")
df %<>% drop_na(efc)
efcdat <- NULL

# employment
df %<>% mutate(employed = empstat > 6)

# wages
df %<>% mutate(wage = coalesce(compJob1,compJob2,compJob3,compJob4,compJob5,compJob6,compJob7,compJob8,compJob9,compJob10,compJob11,compJob12,compJob13,compJob14,compJob15), wage = wage/100)
df %<>% select(-contains("compJob"),-hideg)
# top- and bottom-code wages
df %<>% mutate(wage = replace(wage,wage<8  ,NA))
df %<>% mutate(wage = replace(wage,wage>150,NA))

# education
df %<>% mutate(hgc = replace_na(hgc,0))
df %<>% mutate(collgrad = hgc>=16)

# race and gender
df %<>% mutate(black = race==1, latin = race==2, other = race==3, white = race==4, female = sex==2)

# age
df %<>% mutate(age = 2017-byear)

# parental education
df %<>% mutate(hgcMoth = replace_na(hgcMoth,0))
df %<>% mutate(hgcFath = replace_na(hgcFath,0))
df %<>% mutate(parent_college = (hgcFath>=16 | hgcMoth>=16))

# number of kids
df %<>% mutate(numkids = replace_na(numkids,0))

# throw out people who didn't interview
df %<>% filter(rni<70)

# throw out people who are employed but don't report a wage
df %<>% filter((!is.na(wage) & employed==T) | employed==F)

# change booleans to numerics
df %<>% mutate_if(is.logical,~as.numeric(.))

df %>% skim
df %>% filter(employed==F) %>% skim
df %>% filter(employed==T) %>% skim

# keep subset of variables
df %<>% select(id,female,black,latin,white,employed,wage,collgrad,age,parent_college,numkids,efc)
df %<>% mutate(efc = efc/1000)

df %>% write_csv("slides3data.csv")
